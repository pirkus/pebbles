# Background Agent Startup Configuration

## Automatic Environment Setup

This project includes an automatic setup script that prepares the development environment. 

### Running the Setup Script

When the background agent starts, run the following command from the project root:

```bash
./setup-environment.sh
```

### What the Setup Script Does

1. **Checks Required Tools**
   - Verifies Clojure installation
   - Installs Docker and Docker Compose if missing

2. **Starts Docker Daemon**
   - Checks if Docker is running
   - Starts Docker daemon if needed
   - Handles different init systems (systemd, service, or direct dockerd)

3. **Starts MongoDB**
   - Uses Docker Compose to start MongoDB container
   - Waits for MongoDB to be ready
   - Reuses existing container if already running

4. **Sets Environment Variables**
   - Configures `USE_EXISTING_MONGO=true`
   - Sets `MONGO_URI=mongodb://localhost:27017/test`
   - Creates `.env.test` file for persistence

5. **Verifies Setup**
   - Runs all tests to ensure environment is working
   - Reports success or warnings

### Manual Setup (Alternative)

If you prefer to set up manually:

```bash
# Start Docker daemon
sudo dockerd &

# Start MongoDB
sudo docker-compose up -d mongodb

# Set environment variables
export USE_EXISTING_MONGO=true
export MONGO_URI=mongodb://localhost:27017/test

# Run tests
clojure -X:test
```

### Troubleshooting

- If Docker fails to start, check system logs
- If MongoDB fails, ensure port 27017 is not in use
- Check `.setup-status` file for last successful setup timestamp

### Quick Commands

After setup, use these commands:

- **Run tests**: `USE_EXISTING_MONGO=true MONGO_URI=mongodb://localhost:27017/test clojure -X:test`
- **Start application**: `clojure -M:run`
- **Check MongoDB**: `sudo docker ps | grep mongodb`
- **View MongoDB logs**: `sudo docker logs workspace_mongodb_1`